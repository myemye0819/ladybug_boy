# -*- coding: utf-8 -*-
import pygame
import sys
import random

# Pygame ì´ˆê¸°í™”
pygame.init()

# --- ìƒìˆ˜ ì •ì˜ ë° ì„¤ì • ---
SCREEN_WIDTH = 800
SCREEN_HEIGHT = 600
screen = pygame.display.set_mode((SCREEN_WIDTH, SCREEN_HEIGHT))
pygame.display.set_caption("ì•ˆë…•ë§ˆì´ë ˆì´ë””")

# ìƒ‰ìƒ
BLACK = (0, 0, 0)
WHITE = (255, 255, 255)
LIGHT_PINK = (255, 182, 193)
GRAY_BUTTON = (80, 80, 80)
DIALOG_BOX_COLOR = (30, 30, 30, 200)
PADDING_X = 40

# í°íŠ¸
FONT_PATH = "C:/Windows/Fonts/malgun.ttf" # Windows ê¸°ë³¸ ë§‘ì€ ê³ ë”• í°íŠ¸ ê²½ë¡œ
font_title = pygame.font.Font(FONT_PATH, 40)
font_message = pygame.font.Font(FONT_PATH, 25)
font_option = pygame.font.Font(FONT_PATH, 25)
try:
    font_main = pygame.font.Font(FONT_PATH, 24)
    font_option = pygame.font.Font(FONT_PATH, 20)
    font_affection = pygame.font.Font(FONT_PATH, 20)
except FileNotFoundError:
    print("ê²½ê³ : Malgun í°íŠ¸ ê²½ë¡œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ê¸°ë³¸ í°íŠ¸ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.")
    font_main = pygame.font.Font(None, 24)
    font_option = pygame.font.Font(None, 20)
    font_affection = pygame.font.Font(None, 20)

# UI ìš”ì†Œ ìœ„ì¹˜/í¬ê¸°
DIALOG_HEIGHT = 180
DIALOG_RECT = pygame.Rect(50, SCREEN_HEIGHT - DIALOG_HEIGHT - 20, SCREEN_WIDTH - 100, DIALOG_HEIGHT)
TEXT_START_X = DIALOG_RECT.left + 20
TEXT_START_Y = DIALOG_RECT.top + 20
NAME_BOX_RECT = pygame.Rect(DIALOG_RECT.left, DIALOG_RECT.top - 30, 150, 30)
NAME_TEXT_Y = NAME_BOX_RECT.centery - font_main.get_height() // 2

# 'ì´ì „' ë° 'ë‹¤ì‹œí•˜ê¸°' ë²„íŠ¼ ìœ„ì¹˜ ì •ì˜
PREV_BUTTON_RECT = pygame.Rect(DIALOG_RECT.right + 10, DIALOG_RECT.top, 60, 30)
RESTART_RECT = pygame.Rect(SCREEN_WIDTH // 2 - 100, SCREEN_HEIGHT // 2 + 100, 200, 60)

# --- ê²Œì„ ë°ì´í„° (ë©”ì‹œì§€ ë° í˜¸ê°ë„) ---
messages = [
    ("í”Œë ˆì´ ë°©ë²•", "1. ì—”í„°/ë§ˆìš°ìŠ¤ í´ë¦­ìœ¼ë¡œ ë¬¸ì¥ ë„˜ê¸°ê¸° \n2. ì›í•˜ëŠ” ì„ íƒì§€ë¥¼ í´ë¦­í•˜ì„¸ìš”."),
    ("í™”ì´íŒ…", "ì‚¬ê±´ë“¤ì„ í•´ê²°í•˜ë©´ì„œ ë“±ì¥ì¸ë¬¼ë“¤ì˜ í˜¸ê°ë„ë¥¼ ì˜¬ë ¤ ì‚¬ë‘ì„ ì´ë¤„ë³´ì„¸ìš”!"),
    ("ì™•ìë‹˜", "ë‚´ ì´ë¦„ì€ 'ì™•ìë‹˜'. ì˜¤ëŠ˜ì€ ì „í•™ê°„ í•™êµì—ì„œì˜ ì²«ë‚ ì´ë‹¤. ê³¼ì—° ìƒˆë¡œìš´ ì¹œêµ¬ë“¤ê³¼ ì˜ ì§€ë‚¼ ìˆ˜ ìˆì„ê¹Œ...?"),
    ("ì™•ìë‹˜", "ìƒˆ êµê³¼ì„œë‘ ë‹´ìš”ë‘ ê³¼ìë‘ ì¸í˜•ì´ë‘ ì¹œí•´ì§€ê¸° ìœ„í•œ ë‡Œë¬¼ì¸ ë§ˆì´ì®¸ë‘ ì´Œì§€ë‘ êµ¬ê¸‰ìƒìë‘ íœ´ëŒ€ìš©ìš°ì‚°ì´ë‘ í—¬í‹° ìˆ˜ì €í†µ(ë‚œ ì´ê±° ì—†ìŒ ë°¥ ëª» ë¨¹ì–´)ì´ë‘ì´ê²ƒì €ê²ƒ ì±™ê²¼ë”ë‹ˆ ë„ˆë¬´ë„ˆë¬´ ë¬´ê±°ìš´ ê²ƒ~~"),
    ("ì™•ìë‹˜", "ê·¸ë•Œ ê°‘ìê¸° ì‘ì€ ë¬´ì–¸ê°€ê°€ ë¹ ë¥¸ ì†ë„ë¡œ ë‚˜ì—ê²Œ ë‹¤ê°€ì˜¤ëŠ” ê²ƒì´ì—ˆë˜ ê²ƒì´ì—ˆë‹¤!"),
    ("ì™•ìë‹˜", "''ë„ì•„ì•…!''\në‚˜ëŠ” ë¹„ëª…ì„ ì§€ë¥´ë©° ì†ì„ íœ˜ë‘˜ë €ê³  ê·¸ê²ƒì€ ë‚´ ì†ì— íŠ•ê²¨ì ¸ ë‚˜ê°”ë‹¤."),
    ("ì™•ìë‹˜", "ëº‘ì†Œë‹ˆë²”ì´ ëœ ê²ƒ ê°™ì€ ê¸°ë¶„ì„ ëŠë¼ë©° ë‚˜ëŠ” ì„œë‘˜ëŸ¬ ê·¸ ìë¦¬ë¥¼ ë²—ì–´ë‚¬ë‹¤."),
    ("ì„ ìƒë‹˜", "ë°˜ì— ë„ì°©í–ˆë‹¤.\n''ì–˜ë“¤ì•„ ì˜¤ëŠ˜ ì „í•™ ì˜¨ ì™•ìë‹˜ì´ë¼ê³  í•´. ì˜ ì§€ë‚´''"),
    ("ì™•ìë‹˜", "''ì–˜ë“¤ì•„ ì•ˆë…•! ë‚˜ëŠ” ì™•ìë‹˜ì´ë¼ê³  í•´. ì˜ ì§€ë‚´ë³´ì.''"),
    ("ì™•ìë‹˜", "ë‚˜ëŠ” ì°½ê°€ ë ë§¨ ë’·ìë¦¬ì— ì•‰ê²Œ ë˜ì—ˆë‹¤. ê·¸ëŸ°ë° ê°€ë°©ì€ ìˆëŠ”ë° ë‚´ ì˜†ìë¦¬ê°€ ë¹„ì–´ ìˆì—ˆë‹¤."),
    ("ì„ ìƒë‹˜", "''ê·¸ëŸ°ë° ì£¼ë‹˜ì´ëŠ” ì•„ì§ ì•ˆ ì™”ë‚˜? ì–˜ë“¤ì•„ ì£¼ë‹˜ì´ë‘ ì—°ë½ë˜ëŠ” ì•  ì—†ë‹ˆ??''"),#10
    ("ì™•ìë‹˜", "ì•„ë¬´ë„ ì—†ëŠ” ë“¯í–ˆë‹¤. ì„ ìƒë‹˜ì€ í•œìˆ¨ì„ ì‰¬ê³  ì¡°ë¡€ë¥¼ ëëƒˆë‹¤.\nì„ ìƒë‹˜ì´ ë‚˜ê°€ì‹œìë§ˆì ì•„ì´ë“¤ì´ ë‚´ ìë¦¬ë¡œ ìš°ë¥´ë¥´ ëª°ë ¤ë“¤ì—ˆë‹¤."),
    ("ì¹œêµ¬ë“¤", "''ì–´ë””ì„œ ì™”ì–´?''\n''ëª‡ ì‚´ì´ì•¼??''\n''ì´ë¦„ ì™„ì „ ì‹ ê¸°í•˜ë‹¤~~''"),
    ("ì™•ìë‹˜", "ëŒ€ë‹µí•˜ë ¤ëŠ” ìˆœê°„ ê°‘ìê¸° ë°–ì—ì„œ ë¹„ëª…ì†Œë¦¬ê°€ ë“¤ë ¸ë‹¤. ë„ˆë„ë‚˜ë„ ì°½ë°–ì— ë¶™ì–´ì„œ ë°”ê¹¥ ìƒí™©ì„ ì‚´í”¼ë ¤ê³  í–ˆë‹¤.\nì• ë“¤ ë•Œë¬¸ì— ì•ˆ ë³´ì—¬ì„œ ë‚˜ëŠ” ê·¸ëƒ¥ ë°–ìœ¼ë¡œ ë‚˜ê°”ë‹¤."),
    ("ì™•ìë‹˜", "ì£¼ë³€ì„ ë‘˜ëŸ¬ë³´ë‹ˆ ì–´ë–¤ ì«„ì«„ì´ë¥¼ ì…ê³  ìˆëŠ” ë‚¨ìì•  í•œ ëª…ì´ ì—´ì‹¬íˆ ë–¨ì–´ì§€ëŠ” ë²½ëŒì„ ì¹˜ê³  ìˆì—ˆë‹¤. ë¹„ëª…ì„ ì§€ë¥¸ ì—¬ìì• ëŠ” ì“°ëŸ¬ì ¸ ìˆì—ˆë‹¤."),
    ("ì„ íƒ", "ë¬´ìŠ¨ ì¼ì´ì§€??", [("1. ë„ì™€ì¤€ë‹¤.", "1"), ("2. ë‹¤ì‹œ ë°˜ìœ¼ë¡œ ëŒì•„ê°„ë‹¤.", "2")]), # ì„ íƒì§€ (15)
    ("ì™•ìë‹˜", ""), # 16: ì„ íƒ 1/2ì˜ ê²°ê³¼
    ("ì™•ìë‹˜", "ë°˜ì— ëŒì•„ì˜¤ë‹ˆ ì–´ì§¸ì„ ì§€ ìˆ¨ì„ ê³ ë¥´ê³  ìˆëŠ” ë‚¨ìì• ê°€ ì˜†ìë¦¬ì— ì•‰ì•„ ìˆì—ˆë‹¤. ì•„ë§ˆ ì–˜ê°€ ê·¸ ì£¼ë‹˜ì´ê² ì§€?"), # 17: (ì„ íƒ 2 í›„ ìŠ¤í† ë¦¬)
    ("ì™•ìë‹˜", "ì–´ì¨Œë“  ì¸ì‚¬ëŠ” í•´ì•¼ê² ì§€. \n''ì•ˆë…•, ì˜¤ëŠ˜ ì „í•™ ì˜¨ ì™•ìë‹˜ì´ì•¼. ì˜ ë¶€íƒí•´!''"), # 18
    ("ê³µì£¼ë‹˜", "''ë„Œ...''\nê³ ê°œë¥¼ ì “ê³  ''ì•„, ì•„ë¬´ê²ƒë„ ì•„ë‹ˆì•¼. ë‚œ 'ê³µì£¼ë‹˜'ì´ì•¼. ì´ë¦„ì´ ê³µì£¼ë‹˜.''"), # 19
    ("ì„ íƒ", "ê³µì£¼ë‹˜ì—ê²Œ ë­ë¼ê³  ì¸ì‚¬í• ê¹Œ?", [
        ("1. ì´ê±° ì™„ì „ ìš´ëª…ì¸ë°? ë‚˜ë‘ ì‚¬ê·ˆë˜???", "1"),
        ("2. ê³µì£¼ë‹˜ í–‰ì°¨í•˜ì‹ ë‹¤~~~ ê¸¸ì„ ë¹„ì¼œë¼~~!!", "2"),
        ("3. ì™€ ê·¸ë ‡êµ¬ë‚˜, ì–´ë–»ê²Œ ì´ëŸ° ìš°ì—°ì´!", "3")
    ]), #20
    ("ê³µì£¼ë‹˜", "''....ë­?''\nê³µì£¼ë‹˜ì˜ í‘œì •ì´ ì¼ê·¸ëŸ¬ì¡Œë‹¤."), # 21 (ì„ íƒ 1 ê²°ê³¼)
    ("ì—”ë”©", "ë‹¤ìŒë‚  í•™êµì— ê°€ë³´ë‹ˆ ê³µì£¼ë‹˜ì´ ì „í•™í–ˆë‹¤ëŠ” ì†Œì‹ë§Œì´ ë‚¨ì•˜ë‹¤."), # 22 (ì„ íƒ 1 ê²°ê³¼)
    ("ì—”ë”©", "'ë°°ë“œì—”ë”©'."),#23 (ì„ íƒ 1 ê²°ê³¼, ìµœì¢… ì—”ë”© ë©”ì‹œì§€)
    ("ê³µì£¼ë‹˜", "''í•˜í•˜ ë„ˆ ì§„ì§œ humorousí•˜ê³  funnyë‹¤''"), # 24 (ì„ íƒ 2 ê²°ê³¼)
    ("ì™•ìë‹˜", "''ì™€! ë„ˆ English ì§„ì§œ goodì´ë‹¤!''"), # 25 (ì„ íƒ 2 ê²°ê³¼)
    ("ê³µì£¼ë‹˜", "''ê·¸ëŸ¬ê²Œ''"), # 26 (ì„ íƒ 3 ê²°ê³¼)
    ("ì™•ìë‹˜", "''ì•ìœ¼ë¡œ ì˜ ì§€ë‚´ë³´ì!''"), # 27 (ì„ íƒ 3 ê²°ê³¼)
    ("ì™•ìë‹˜", "ëˆˆì„ ë– ë³´ë‹ˆ ë²Œì¨ ê¸‰ì‹ì‹œê°„ì´ì—ˆë‹¤."),
    ("ê³µì£¼ë‹˜", "''ì•¼ ì¼ì–´ë‚˜! ìˆ˜ì—…ì€ ì•ˆ ë“¤ì–´ë„ ë°¥ì€ ë¨¹ì–´ì•¼ì§€.''"),
    ("ê³µì£¼ë‹˜", "''ì–¼ë¥¸ ê¸‰ì‹ë³µ ì…ì–´. ìš°ë¦¬ í•™êµ ê¸‰ì‹ ë¨¹ëŠ” ë°©ë²•ì´ ë˜ê²Œ íŠ¹ì´í•´ì„œ ë¯¼ì²©í•˜ê²Œ ì›€ì§ì—¬ì•¼ í•´.''"),
    ("ì™•ìë‹˜", "''ê·¼ë° ë‚˜ëŠ” ì˜¤ëŠ˜ ì „í•™ ì™€ì„œ ê¸‰ì‹ë³µì´ ì—†ëŠ”ë°...?''"),
    ("ê³µì£¼ë‹˜", "''ê·¸ëŸ¼ ì–´ì©” ìˆ˜ ì—†ì§€. ì˜ ë¨¹ì–´ë´ã…‹''"),
    ("ì™•ìë‹˜", "'ê·¼ë° ëŒ€ì²´ ê¸‰ì‹ì„ ì–´ë–»ê²Œ ë¨¹ê¸¸ë˜ ê¸‰ì‹ë³µì´ í•„ìš”í•œ ê±°ì§€...?'\në‚˜ì™€ ê³µì£¼ë‹˜ì€ ìš´ë™ì¥ìœ¼ë¡œ í–¥í–ˆë‹¤.\n'ê·¼ë° ëŒ€ì²´ ê¸‰ì‹ì„ ì–´ë–»ê²Œ ë¨¹ê¸¸ë˜ ìš´ë™ì¥ì—ì„œ ë¨¹ëŠ” ê±°ì§€...?'"),
    ("ê³µì£¼ë‹˜", "''ì´ì œ í•˜ëŠ˜ì—ì„œ ê¸‰ì‹ì´ ë–¨ì–´ì§ˆ ê±´ë° ì˜ ë°›ì•„ ë¨¹ì–´ ë´. ê°„í˜¹ ìƒˆë˜¥ì´ ìˆì„ ìˆ˜ ìˆëŠ”ë° ê·¸ê²ƒë„ ì˜ í”¼í•´ì•¼ í•˜ì—¬.''"),#34
    ("ì„ íƒ", "í•˜ëŠ˜ì—ì„œ ìŒì‹ì´ ë–¨ì–´ì§„ë‹¤. ë°©í–¥í‚¤ë¡œ ë–¨ì–´ì§€ëŠ” ê¸‰ì‹ì„ ì˜ ë¨¹ì–´ ë³´ì.\nê°€ë” ê°€ë‹¤ ìŒì‹ì´ ì•„ë‹Œ ê²Œ ë–¨ì–´ì§ˆ ìˆ˜ ìˆëŠ”ë° ì˜ í”¼í•´ì•¼ í•œë‹¤.", [("ë¨¹ëŠ”ë‹¤.", "1")]),#35,
    ("ì™•ìë‹˜", "''ì•„ ì˜ ë¨¹ì—ˆë‹¤~^^ ê·¼ë° ì—¬ê¸° ê¸‰ì‹ ë˜ê²Œ íŠ¹ì´í•˜ë‹¤''"),
    ("ê³µì£¼ë‹˜", "''ìš°ë¦¬ êµì¥ìŒ¤ì´ í•˜ëŠ˜ì—ì„œ ìŒì‹ì´ ë–¨ì–´ì§„ë‹¤ë¥¼ ê°ëª…ê¹Šê²Œ ë´ì„œ ê·¸ë˜. \nê·¸ë¦¬ê³  ë„ˆ ì´ë¦„ì´ ë” íŠ¹ì´í•´.''"),
    ("ì™•ìë‹˜", "''ë­ë¼ê³ ??''"),
    ("ì„ íƒ", "ê³µì£¼ë‹˜ì—ê²Œ ë­ë¼ê³  ëŒ€ë‹µí• ê¹Œ?", [
        ("1. ë„ˆ ì •ë§ ì¬ì¹˜ ìˆê³  FUNNYí•˜ë‹¤~", "1"),
        ("2. ì§€ëŠ”", "2"),
        ("3. ì•„ì§„ì§œìš”", "3")
    ]), #39
    ("ê³µì£¼ë‹˜", "TANK~"),#40 ì„ íƒ1ê²°
    ("ê³µì£¼ë‹˜", "''ë­??''\nê³µì£¼ë‹˜ì˜ í‘œì •ì´ ì¢‹ì§€ ì•Šë‹¤. ë­”ê°€ ì˜ëª» ë§í•œ ê²ƒ ê°™ë‹¤."),#41 ì„ íƒ2ê²°
    ("ê³µì£¼ë‹˜", "''ì‘ê·¸ë˜.''"),#42 ì„ íƒ3ê²°
    ("ìƒí™©", "ê·¸ë•Œì˜€ë‹¤. ì–´ë””ì„ ê°€ ë¹„ëª…ì†Œë¦¬ê°€ ë“¤ë ¤ì™”ë‹¤."),
    ("ì—¬í•™ìƒ1", "''êº„ì•„ì•„ì•„ì•…!!! ë±€ì´ì•¼!!''\nì˜¤ëŠ˜ ì•„ì¹¨ ë²½ëŒì‚¬ê±´ ë•Œì˜ ê·¸ ì—¬ìì•„ì´ì˜€ë‹¤. ì–´ì©ì§€ ë¹„ëª…ì´ ìµìˆ™í•˜ë”ë¼ë‹ˆ..."),
    ("í•™ìƒë“¤", "''ë­!? ë±€ì´ë¼ê³ !? ë‹¤ë“¤ ë„ë§ì³!!''\n''ë±€ì´ë‹¤~ ë±€ì´ë‹¤~''\n''ì—¬ê¸°ì„œ ì£½ì„ ì‘¨ ì—†ì–´!''"),
    ("ìƒí™©", "í•™ìƒë“¤ê³¼ ì„ ìƒë‹˜ë“¤ì´ ëª¨ë‘ í˜¼ë¹„ë°±ì‚° ë„ë§ì¹˜ê¸° ì‹œì‘í–ˆë‹¤. ë•ë¶„ì— í•™êµì—ëŠ” ê³µì£¼ë‹˜ê³¼ ë‚˜ë°–ì— ë‚¨ì§€ ì•Šì•˜ë‹¤."), #46
    ("ì™•ìë‹˜", "''ì•„ë‹ˆ ì•„ë¬´ë¦¬ ê·¸ë˜ë„ ê·¸ë ‡ì§€, ì´ëŸ´ ìˆ˜ê°€ ìˆë‚˜...?? ì£¼ë‹˜ì•„ ë„ˆë„ ê·¸ë ‡ê²Œ ìƒê°-\n...ì‘..?''"),
    ("ì™•ìë‹˜", "ì£¼ìœ„ë¥¼ ì•„ë¬´ë¦¬ ë‘˜ëŸ¬ë´ë„ ì£¼ë‹˜ì´ê°€ ì—†ë‹¤. ë¶„ëª… ì•„ê¹Œê¹Œì§€ ì˜†ì— ìˆì—ˆëŠ”ë°... ì•„ë¬´ë˜ë„ ë‹¤ë¥¸ í•™ìƒë“¤ì—ê²Œ ë°€ë ¤ ë°–ìœ¼ë¡œ ë‚˜ê°„ ê²ƒ ê°™ì•˜ë‹¤."),
    ("ì™•ìë‹˜", "''ì–´ì©” ìˆ˜ ì—†ì§€.''\nê²°êµ­ ë‚˜ë„ í•™êµ ë°–ìœ¼ë¡œ ë‚˜ê°€ë ¤ë˜ ì°°ë‚˜, ì¸ê¸°ì²™ì´ ëŠê»´ì§€ë”ë‹ˆ ëˆ„êµ°ê°€ê°€ ë‚´ íŒ”ì„ ì¡ì•„ë‹¹ê²¼ë‹¤."),
    ("???", "''ìœ„í—˜í•´!!!''\në’¤ë¥¼ ëŒì•„ë³´ë‹ˆ ë±€ì´ ì†¡ê³³ë‹ˆë¥¼ ë“¤ì´ë°€ë©° ë‚˜ì—ê²Œ ë‹¬ë ¤ì˜¤ê³  ìˆì—ˆë‹¤. ë‹¤í–‰íˆ ëˆ„êµ°ê°€ê°€ ë§‰ì•„ì¤€ ë•ë¶„ì— ë‹¤ì¹˜ì§€ ì•Šì•˜ë‹¤."),
    ("ì™•ìë‹˜", "''ì–´? ë„ˆëŠ” ì•„ì¹¨ì— ë´¤ë˜ ê·¸... ì«„ì«„ì´!?''"),
    ("ë ˆë²…ë³´ì´", "''ìª¼, ì«„ì«„ì´ë¼ë‹ˆ..!! ë‚œ ë ˆì´ë””ë²„ê·¸ ë³´ì´ì•¼. ë“¤ì–´ë³¸ ì  ì—†ì–´??''"),
    ("ì„ íƒ", "ë ˆì´ë””ë²„ê·¸ ë³´ì´ì—ê²Œ ë­ë¼ê³  ëŒ€ë‹µí• ê¹Œ?", [
        ("1. ë“¤ì–´ë³¸ ì  ì—†ëŠ”ë°...", "1"),
        ("2. ì–´ë””ì„œ ë“¤ì–´ë´¤ë˜ ê²ƒ ê°™ì•„!", "2"),
        ("3. ë‚´ê°€ ì™œ ì•Œì•„ì•¼ í•´? ë„ˆ ê·¸ê±° ìì˜ì‹ ê³¼ingì´ì•¼", "3"),
    ]), #53
    ("ë ˆë²…ë³´ì´", "''ìœ¼ìœ½..!!''\nê·¸ë•Œ ê°‘ìê¸° ë ˆë²…ë³´ì´ê°€ íŒ”ì„ ì¡ê³  ì“°ëŸ¬ì¡Œë‹¤. ì•„ë¬´ë˜ë„ ì•„ê¹Œ ë‚˜ë¥¼ êµ¬í•  ë•Œ ëŒ€ì‹  ë±€ì— ë¬¼ë¦° ê²ƒ ê°™ì•˜ë‹¤."),
    ("ë ˆë²…ë³´ì´", "''ì´ë ‡ê²Œ ëœ ì´ìƒ..! ë¶€íƒì´ì•¼ ì™•ìë‹˜, ë‚˜ ëŒ€ì‹  ë±€ì„ ë§‰ì•„ì¤˜!''"),
    ("ì™•ìë‹˜", "''ì–´??? ì•„, ì•Œì•˜ì–´..! ''\nê·¸ëŸ°ë° ë‚´ ì´ë¦„ì„ ì–´ë–»ê²Œ ì•ˆ ê±°ì§€? ìì„¸íˆ ìƒê°í•  í‹ˆë„ ì—†ì´ ë‹¤ì‹œ ë±€ì´ ì´ìª½ìœ¼ë¡œ í–¥í–ˆë‹¤."),
    ("ì„ íƒ", "ë±€ì„ ì£¼ë³€ì— ë–¨ì–´ì§„ ë‚¨ì€ ìŒì‹ë“¤ë¡œ ìœ ì¸í•´ ê²©íŒŒí•˜ì. ë°©í–¥í‚¤ë¡œ ì¡°ì¢…í•  ìˆ˜ ìˆë‹¤.", [("ì‹¸ìš´ë‹¤", "1")]),#57
    ("ì™•ìë‹˜", "ë°°ê°€ ë¹µë¹µí•´ì§„ ë±€ì´ ì˜†ìœ¼ë¡œ í„¸ì© ì“°ëŸ¬ì¡Œë‹¤. ëë‚œ ê²ƒ ê°™ë‹¤. ë‚˜ëŠ” ë ˆë²…ë³´ì´ì—ê²Œ ë‹¤ê°€ê°”ë‹¤.\n''ë ˆë²…ì•„ ë„ˆ ê´œì°®ì•„!?''"),
    ("ë ˆë²…ë³´ì´", "''ì ê¹, ì§€ê¸ˆ ì˜¤ë©´..!!''\nê°‘ìê¸° ë ˆë²…ë³´ì´í•œí…Œì„œ ì—„ì²­ë‚œ ë¹›ì´ ìƒˆì–´ë‚˜ì˜¤ê¸° ì‹œì‘í–ˆë‹¤. ê³¤ì¶©ì´ë¼ ë³€íƒœë¥¼ í•˜ëŠ” ê±´ê°€..?"),#59
    ("ì™•ìë‹˜", "''ì–´..? ë„ˆëŠ”......''"),
    ("ê³µì£¼ë‹˜", "''........''"),#61
    ("ê³µì£¼ë‹˜", "''ë§ì•„, ë‚´ê°€ ë ˆì´ë””ë²„ê·¸ ë³´ì´ì•¼.''"),
    ("ê³µì£¼ë‹˜", "''ê·¸ë¦¬ê³  ë‚´ ì •ì²´ë¥¼ ì´ë¯¸ ë“¤ì¼œë²„ë¦° ì´ìƒ, ë‚´ ë§ˆìŒì„ ì „í•´ì•¼ í•  ê²ƒ ê°™ì•„.''"), #63 í˜¸ê°ë„ ì¼ì • ì´ìƒì´ì—ˆì„ ë•Œ ì§„í–‰
    ("ê³µì£¼ë‹˜", "ë‚˜.. ë„ ì¢‹ì•„í•´. ì´ëŸ° ë‚´ ë§ˆìŒì„ ë°›ì•„ì¤„ë˜?"), #64
    ("ì„ íƒ", "ê³µì£¼ë‹˜ì˜ ë§ˆìŒì„ ë°›ì•„ì¤„ê¹Œ?", [
        ("1. ê·¸ë˜ ì¢‹ì•„.", "1"),
        ("2. ì‹«ì–´.", "2"),
    ]), #65
    ("ê³µì£¼ë‹˜", "''ë‹¤ë¥¸ ì‚¬ëŒë“¤ì—ê²Œ ë§í•˜ê³  ë‹¤ë‹ˆì§„ ë§ì•„ì¤˜. ì •ì²´ë¥¼ ë“¤ì¼°ìœ¼ë‹ˆ ë‚œ ì´ì œ ì´ê³³ì„ ë– ë‚˜ì•¼ í•  ê±° ê°™ì•„. ì•ˆë…•.''"), #66 í˜¸ê°ë„ ì¼ì • ì´í•˜ì¼ ë•Œ ì—”ë”©, ì¸ë±ìŠ¤64ì—ì„œ 2ë²ˆì„ ì„ íƒí–ˆì„ ë•Œ ì—”ë”©
    ("ì—”ë”©", "ë‹¤ìŒë‚  í•™êµì— ê°€ë³´ë‹ˆ ì˜†ìë¦¬ëŠ” ë¹„ì–´ ìˆì—ˆê³  ê³µì£¼ë‹˜ì´ ì „í•™ê°”ë‹¤ëŠ” ì†Œì‹ë§Œì´ ë“¤ë ¤ì˜¬ ë¿ì´ì—ˆë‹¤.\n-'í‰ë²”ì—”ë”©'."),#67
    ("ê³µì£¼ë‹˜", "''...!! ê³ ë§ˆì›Œ!''"), #ì¸ë±ìŠ¤64ì—ì„œ 1ë²ˆì„ ì„ íƒí–ˆì„ ë–„ ì—”ë”© #68
    ("ì—”ë”©", "ê·¸ë ‡ê²Œ ë ˆì´ë””ë²„ê·¸ ë³´ì´ì™€ í•¨ê»˜ ì‚¬ê±´ì„ í•´ê²°í•˜ê³ , ê³µì£¼ë‹˜ê³¼ í•™êµë¥¼ ë‹¤ë‹ˆë©° ì¦ê±°ìš´ ìƒí™œì„ ë³´ëƒˆë‹¤."),
    ("ì—”ë”©", "'í•´í”¼ì—”ë”©'.")#70
    
]
ORIGINAL_MESSAGE_COUNT = len(messages)

message_index = 0
í˜¸ê°ë„ = {
    "ë ˆë²…ë³´ì´": 0,
    "ê³µì£¼ë‹˜" : 0
}
ë“±ì¥í•œ_ìºë¦­í„° = set()

# ê²Œì„ ì¢…ë£Œ í”Œë˜ê·¸
game_over = False

# --- ê²Œì„ ìƒíƒœ ì´ˆê¸°í™” í•¨ìˆ˜ ---
def reset_game():
    """ê²Œì„ ìƒíƒœë¥¼ ì´ˆê¸°í™”í•˜ê³  ì²˜ìŒìœ¼ë¡œ ë˜ëŒë¦½ë‹ˆë‹¤."""
    global message_index, í˜¸ê°ë„, ë“±ì¥í•œ_ìºë¦­í„°, game_over, messages
    
    # 1. ë³€ìˆ˜ ì´ˆê¸°í™”
    message_index = 0
    í˜¸ê°ë„ = {
        "ë ˆë²…ë³´ì´": 0,
        "ê³µì£¼ë‹˜" : 0
    }
    ë“±ì¥í•œ_ìºë¦­í„° = set()
    ë“±ì¥í•œ_ìºë¦­í„°.add("ë ˆë²…ë³´ì´")
    game_over = False
    
    # 2. ë¯¸ë‹ˆê²Œì„ ê²°ê³¼ë¡œ ì¶”ê°€ëœ ë©”ì‹œì§€ ì œê±° (ì›ë³¸ ê¸¸ì´ë¡œ ë³µêµ¬)
    if len(messages) > ORIGINAL_MESSAGE_COUNT:
        del messages[ORIGINAL_MESSAGE_COUNT:]
        
    # 3. ìŠ¤í† ë¦¬ ë¶„ê¸° ë©”ì‹œì§€ ì´ˆê¸°í™” (ë¯¸ë‹ˆê²Œì„1 ê²°ê³¼ê°€ ì €ì¥ë˜ëŠ” ì¸ë±ìŠ¤ 16)
    messages[16] = ("ì™•ìë‹˜", "")
    
    print("--- ê²Œì„ì´ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤. ---")

# --- ë¯¸ë‹ˆê²Œì„: ë²½ëŒ ê²Œì„ (ì›ë³¸ ìœ ì§€) ---
def brick_game():
    # ... (ë²½ëŒ ê²Œì„ ì½”ë“œ ìœ ì§€)
    game_screen = screen
    pygame.display.set_caption("ë²½ëŒ ê²Œì„ - ë¯¸ë‹ˆê²Œì„")
    # ìƒ‰
    BLACK = (0, 0, 0)
    BLUE = (0, 0, 255)
    RED = (255, 0, 0)
    WHITE = (255, 255, 255)

    # íŒ¨ë“¤
    paddle = pygame.Rect(350, 550, 100, 10)
    paddle_speed = 7

    # ê³µ
    ball = pygame.Rect(390, 300, 20, 20)
    ball_speed = [4, -4]

    # ë²½ëŒ
    bricks = []
    brick_width = 200
    brick_height = 40
    for i in range(3):  # ì¤„
        for j in range(3):  # ì¹¸
            x = j * (brick_width + 20) + 100
            y = i * (brick_height + 10) + 40
            bricks.append(pygame.Rect(x, y, brick_width, brick_height))

    clock = pygame.time.Clock()
    running = True
    cleared = False

    while running:
        for event in pygame.event.get():
            if event.type == pygame.QUIT:
                running = False
                return False

        keys = pygame.key.get_pressed()
        if keys[pygame.K_LEFT] and paddle.left > 0:
            paddle.x -= paddle_speed
        if keys[pygame.K_RIGHT] and paddle.right < 800:
            paddle.x += paddle_speed

        # ê³µ ì´ë™
        ball.x += ball_speed[0]
        ball.y += ball_speed[1]

        # ë²½ ì¶©ëŒ
        if ball.left <= 0 or ball.right >= 800:
            ball_speed[0] = -ball_speed[0]
        if ball.top <= 0:
            ball_speed[1] = -ball_speed[1]
        if ball.bottom >= 600:  # ë°”ë‹¥ì— ë‹¿ìŒ
            running = False
            cleared = False

        # íŒ¨ë“¤ ì¶©ëŒ
        if ball.colliderect(paddle):
            ball_speed[1] = -abs(ball_speed[1])

        # ë²½ëŒ ì¶©ëŒ
        hit_index = ball.collidelist(bricks)
        if hit_index != -1:
            bricks.pop(hit_index)
            ball_speed[1] = -ball_speed[1]

        # í™”ë©´ í´ë¦¬ì–´
        game_screen.fill(BLACK)
        pygame.draw.rect(game_screen, BLUE, paddle)
        pygame.draw.ellipse(game_screen, WHITE, ball)

        for brick in bricks:
            pygame.draw.rect(game_screen, RED, brick)

        pygame.display.flip()
        clock.tick(60)

        if not bricks:  # ë²½ëŒ ë‹¤ ë¶€ìˆ¨ â†’ ì„±ê³µ
            running = False
            cleared = True

    pygame.display.set_caption("ì•ˆë…•ë§ˆì´ë ˆì´ë””")
    return cleared

# --- ë¯¸ë‹ˆê²Œì„: í•˜ëŠ˜ì—ì„œ ë–¨ì–´ì§€ëŠ” ê¸‰ì‹ (ìˆ˜ì •: ì´ë¯¸ì§€ ì‚¬ìš©) ---
def sky_food_game():
    pygame.display.set_caption("í•˜ëŠ˜ì—ì„œ ê¸‰ì‹ì´ ë–¨ì–´ì§„ë‹¤ - ë¯¸ë‹ˆê²Œì„")
    clock = pygame.time.Clock()
    running = True

    # ì´ë¯¸ì§€ í¬ê¸° ì¡°ì • (ì•„ì´í…œ í¬ê¸° 30x30ì— ë§ì¶¤)
    try:
        FOOD_IMAGE = pygame.transform.scale(ê¸‰ì‹_image, (70, 70))
        BAD_IMAGE = pygame.transform.scale(ìƒˆë˜¥_image, (70, 70))
    except NameError:
        print("ê²½ê³ : ë¯¸ë‹ˆê²Œì„ ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨. ëŒ€ì²´ ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.")
        FOOD_IMAGE = pygame.Surface((30, 30)); pygame.draw.circle(FOOD_IMAGE, (240, 200, 0), (15, 15), 15)
        BAD_IMAGE = pygame.Surface((30, 30)); BAD_IMAGE.fill((30, 30, 30))

    # í”Œë ˆì´ì–´ (ë°”êµ¬ë‹ˆ)
    player = pygame.Rect(SCREEN_WIDTH // 2 - 40, SCREEN_HEIGHT - 80, 80, 30)
    player_speed = 8

    # ì•„ì´í…œ ì •ë³´
    items = []
    spawn_interval = 800  # ms
    last_spawn = pygame.time.get_ticks()

    start_time = pygame.time.get_ticks()
    duration = 20000  # 20ì´ˆ ë™ì•ˆ ì§„í–‰
    score = 0
    hit_bad = False

    small_font = font_option

    while running:
        now = pygame.time.get_ticks()
        elapsed = now - start_time
        for event in pygame.event.get():
            if event.type == pygame.QUIT:
                pygame.quit()
                sys.exit()

        keys = pygame.key.get_pressed()
        if keys[pygame.K_LEFT] and player.left > 0:
            player.x -= player_speed
        if keys[pygame.K_RIGHT] and player.right < SCREEN_WIDTH:
            player.x += player_speed

        # ìŠ¤í°
        if now - last_spawn >= spawn_interval:
            last_spawn = now
            if random.random() < 0.75:
                item_type = 'food'
            else:
                item_type = 'bad'
            x = random.randint(20, SCREEN_WIDTH - 20)
            rect = pygame.Rect(x, -30, 30, 30)
            speed = random.randint(3, 6)
            items.append({'rect': rect, 'type': item_type, 'speed': speed})

            if spawn_interval > 300:
                spawn_interval = max(300, spawn_interval - 5)

        # ì´ë™ ë° ì¶©ëŒ ê²€ì‚¬
        for it in items[:]:
            it['rect'].y += it['speed']
            if it['rect'].colliderect(player):
                if it['type'] == 'food':
                    score += 10
                    items.remove(it)
                else:  # bad
                    hit_bad = True
                    running = False
                    break
            elif it['rect'].top > SCREEN_HEIGHT:
                items.remove(it)

        # ì¢…ë£Œ ì¡°ê±´: ì‹œê°„ ë
        if elapsed >= duration:
            running = False

        # ê·¸ë¦¬ê¸°
        screen.fill((80, 170, 220))  # í•˜ëŠ˜ìƒ‰ ë°°ê²½
        # ë°”ë‹¥, í”Œë ˆì´ì–´
        pygame.draw.rect(screen, (60, 120, 60), (0, SCREEN_HEIGHT - 100, SCREEN_WIDTH, 100))
        pygame.draw.rect(screen, (150, 75, 0), player)  # ë°”êµ¬ë‹ˆ

        # ì•„ì´í…œ ê·¸ë¦¬ê¸° (ì´ë¯¸ì§€ ì‚¬ìš©)
        for it in items:
            if it['type'] == 'food':
                screen.blit(FOOD_IMAGE, it['rect'])
            else:
                screen.blit(BAD_IMAGE, it['rect'])

        # ì ìˆ˜ì™€ ë‚¨ì€ì‹œê°„ í‘œì‹œ
        time_left = max(0, (duration - elapsed) // 1000)
        score_surf = small_font.render(f"ì ìˆ˜: {score}", True, WHITE)
        time_surf = small_font.render(f"ë‚¨ì€ì‹œê°„: {time_left}s", True, WHITE)
        screen.blit(score_surf, (10, 10))
        screen.blit(time_surf, (10, 40))

        pygame.display.flip()
        clock.tick(60)

    pygame.display.set_caption("ì•ˆë…•ë§ˆì´ë ˆì´ë””")
    return score, hit_bad


# --- ë¯¸ë‹ˆê²Œì„: ë±€ê³¼ì˜ ì „íˆ¬ (Pygame ìŠ¤ë„¤ì´í¬) ---
# -------------------------------------------------------------------
def snake_game():
    pygame.display.set_caption("ë±€ê³¼ì˜ ì „íˆ¬ - ë¯¸ë‹ˆê²Œì„ (ìŠ¤ë„¤ì´í¬)")
    clock = pygame.time.Clock()
    running = True

    # ê²Œì„ ìƒìˆ˜
    GRID_SIZE = 20
    GRID_WIDTH = SCREEN_WIDTH // GRID_SIZE
    GRID_HEIGHT = SCREEN_HEIGHT // GRID_SIZE
    
    # ë±€
    snake_pos = [(GRID_WIDTH // 2, GRID_HEIGHT // 2)]
    snake_direction = (1, 0) # ì˜¤ë¥¸ìª½
    
    # ë¨¹ì´ (ìƒˆë˜¥ ì´ë¯¸ì§€)
    try:
        FOOD_IMAGE = pygame.transform.scale(ìƒˆë˜¥_image, (GRID_SIZE, GRID_SIZE))
    except NameError:
        print("ê²½ê³ : ìƒˆë˜¥ ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨. ëŒ€ì²´ ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.")
        FOOD_IMAGE = pygame.Surface((GRID_SIZE, GRID_SIZE)); FOOD_IMAGE.fill((30, 30, 30))

    # ì£¼ë³€ì— ë–¨ì–´ì§„ ìŒì‹ ì•„ì´í…œ (íšë“í•´ì•¼ í•  ëª©í‘œ)
    try:
        ITEM_IMAGE = pygame.transform.scale(ê¸‰ì‹_image, (GRID_SIZE, GRID_SIZE))
    except NameError:
        ITEM_IMAGE = pygame.Surface((GRID_SIZE, GRID_SIZE)); ITEM_IMAGE.fill((0, 200, 0))
    
    # ì•„ì´í…œ ë°°ì¹˜
    items = []
    def place_item():
        while True:
            x = random.randint(0, GRID_WIDTH - 1)
            y = random.randint(0, GRID_HEIGHT - 1)
            if (x, y) not in snake_pos and (x, y) not in [i['pos'] for i in items]:
                items.append({'pos': (x, y), 'type': 'item'})
                break

    # ë±€ (ì ) ë°°ì¹˜ (ì›€ì§ì´ì§€ ì•ŠëŠ” ì¥ì• ë¬¼ë¡œ ì‚¬ìš©)
    # * ì—¬ê¸°ì„œëŠ” ë±€ì´ ê³µê²© ëª©í‘œì´ë¯€ë¡œ, ë¨¹ì´(ìƒˆë˜¥)ë¥¼ ë¨¹ì´ê³  ë©ì¹˜ë¥¼ ë¶ˆë¦¬ëŠ” ê²ƒì„ ë¯¸ì…˜ìœ¼ë¡œ ë³€ê²½í•©ë‹ˆë‹¤.
    #   ë¯¸ë‹ˆê²Œì„ ì´ë¦„ê³¼ ëª©í‘œëŠ” "ë±€ì—ê²Œ ë¨¹ì´ë¥¼ ë¨¹ì—¬ ë±€ì˜ ì›€ì§ì„ì„ ë‘”í™”ì‹œí‚¤ëŠ” ê²ƒ"ìœ¼ë¡œ ê°„ì£¼í•©ë‹ˆë‹¤.
    
    # ì´ˆê¸° ì•„ì´í…œ ë°°ì¹˜
    for _ in range(3):
        place_item()
        
    score = 0
    
    # ë±€ ì´ë™ ì†ë„ (í”„ë ˆì„ ë‹¨ìœ„)
    # ì†ë„ê°€ ë‚®ì„ìˆ˜ë¡(ê°’ì´ í´ìˆ˜ë¡) ëŠë¦¼
    snake_speed = 10 
    time_since_last_move = 0
    
    # í°íŠ¸
    small_font = font_option
    
    while running:
        # ì‹œê°„ ê²½ê³¼ ì²´í¬
        dt = clock.tick(60) 
        time_since_last_move += dt

        for event in pygame.event.get():
            if event.type == pygame.QUIT:
                pygame.quit()
                sys.exit()
            
            # ë°©í–¥í‚¤ ì…ë ¥
            if event.type == pygame.KEYDOWN:
                if event.key == pygame.K_UP and snake_direction != (0, 1):
                    snake_direction = (0, -1)
                elif event.key == pygame.K_DOWN and snake_direction != (0, -1):
                    snake_direction = (0, 1)
                elif event.key == pygame.K_LEFT and snake_direction != (1, 0):
                    snake_direction = (-1, 0)
                elif event.key == pygame.K_RIGHT and snake_direction != (-1, 0):
                    snake_direction = (1, 0)

        # ë±€ ì´ë™ (ì†ë„ ì œì–´)
        if time_since_last_move >= snake_speed * 10: # 100msë§ˆë‹¤ ì´ë™
            time_since_last_move = 0
            
            # ìƒˆ ë¨¸ë¦¬ ìœ„ì¹˜ ê³„ì‚°
            new_head_x = snake_pos[0][0] + snake_direction[0]
            new_head_y = snake_pos[0][1] + snake_direction[1]
            new_head = (new_head_x, new_head_y)

            # 1. ê²½ê³„ ì¶©ëŒ ê²€ì‚¬
            if not (0 <= new_head_x < GRID_WIDTH and 0 <= new_head_y < GRID_HEIGHT):
                running = False
                return score, False # ì‹¤íŒ¨ (ë²½ì— ë¶€ë”ªí˜)

            # 2. ëª¸í†µ ì¶©ëŒ ê²€ì‚¬
            if new_head in snake_pos:
                running = False
                return score, False # ì‹¤íŒ¨ (ìì‹ ì—ê²Œ ë¶€ë”ªí˜)

            # 3. ì•„ì´í…œ ì¶©ëŒ (ìƒˆë˜¥)
            item_hit = False
            for i, item in enumerate(items):
                if new_head == item['pos']:
                    score += 10
                    snake_speed += 1 # ì†ë„ ê°ì†Œ (ëŠë ¤ì§)
                    del items[i]
                    place_item() # ìƒˆ ì•„ì´í…œ ìƒì„±
                    item_hit = True
                    break

            # ë±€ ì´ë™ ì ìš©
            snake_pos.insert(0, new_head)
            if not item_hit: # ì•„ì´í…œì„ ë¨¹ì§€ ì•Šì•˜ìœ¼ë©´ ê¼¬ë¦¬ ì œê±° (ê¸¸ì´ ìœ ì§€)
                snake_pos.pop()

            # ìŠ¹ë¦¬ ì¡°ê±´: ì¼ì • ì ìˆ˜ ì´ìƒ
            if score >= 50:
                running = False
                return score, True # ì„±ê³µ


        # ê·¸ë¦¬ê¸°
        screen.fill((100, 140, 100)) # ìˆ² ë°°ê²½ ëŠë‚Œ

        # ì•„ì´í…œ ê·¸ë¦¬ê¸°
        for item in items:
            rect = pygame.Rect(item['pos'][0] * GRID_SIZE, item['pos'][1] * GRID_SIZE, GRID_SIZE, GRID_SIZE)
            screen.blit(ITEM_IMAGE, rect)

        # ë±€ ê·¸ë¦¬ê¸°
        for i, pos in enumerate(snake_pos):
            rect = pygame.Rect(pos[0] * GRID_SIZE, pos[1] * GRID_SIZE, GRID_SIZE, GRID_SIZE)
            color = (255, 100, 100) if i == 0 else (200, 50, 50) # ë¨¸ë¦¬/ëª¸í†µ ìƒ‰ìƒ
            pygame.draw.rect(screen, color, rect)
            pygame.draw.rect(screen, BLACK, rect, 1) # ê²½ê³„ì„ 

        # ì ìˆ˜ í‘œì‹œ
        score_surf = small_font.render(f"ë±€ì—ê²Œ ë¨¹ì¸ ì ìˆ˜: {score}", True, WHITE)
        speed_surf = small_font.render(f"ë±€ì˜ ë‘”í™” ì •ë„: {snake_speed - 10}", True, WHITE)
        screen.blit(score_surf, (10, 10))
        screen.blit(speed_surf, (10, 40))

        # ëª©í‘œ í‘œì‹œ
        target_surf = small_font.render("ëª©í‘œ: ì ìˆ˜ 50ì  ë‹¬ì„± (ë‘”í™”ì‹œí‚¤ê¸°)", True, (255, 255, 0))
        screen.blit(target_surf, (SCREEN_WIDTH - target_surf.get_width() - 10, 10))
        
        pygame.display.flip()

    pygame.display.set_caption("ì•ˆë…•ë§ˆì´ë ˆì´ë””")
    return score, False # ì‹¤íŒ¨ë¡œ ì¢…ë£Œëœ ê²½ìš°

# --- ì´ë¯¸ì§€ ë¡œë“œ (ê²½ë¡œë¥¼ ë°˜ë“œì‹œ í™•ì¸í•˜ì„¸ìš”!) ---
try:
    # ì´ë¯¸ì§€ë¥¼ 30x30ìœ¼ë¡œ ë¯¸ë¦¬ ì¡°ì •í•˜ì—¬ ë¡œë“œ (ë¯¸ë‹ˆê²Œì„ìš©)
    bg = pygame.transform.scale(
        pygame.image.load(r"C:\Users\yerin\OneDrive\ë°”íƒ• í™”ë©´\ë ˆë²…\image\bg.png").convert(), (SCREEN_WIDTH, SCREEN_HEIGHT))
    êµì‹¤1 = pygame.transform.scale(
        pygame.image.load(r"C:\Users\yerin\OneDrive\ë°”íƒ• í™”ë©´\ë ˆë²…\image\êµì‹¤.jpg").convert(), (SCREEN_WIDTH, SCREEN_HEIGHT))
    ìš´ë™ì¥ = pygame.transform.scale(
        pygame.image.load(r"C:\Users\yerin\OneDrive\ë°”íƒ• í™”ë©´\ë ˆë²…\image\ìš´ë™ì¥.png").convert(), (SCREEN_WIDTH, SCREEN_HEIGHT))
    ë ˆë²…ë³´ì´_image = pygame.transform.scale(
        pygame.image.load(r"C:\Users\yerin\OneDrive\ë°”íƒ• í™”ë©´\ë ˆë²…\image\ë¬´ë‹¹ë²Œë ˆ.png").convert_alpha(), (300, 300))
    ë ˆë²…ë³´ì´2_image = pygame.transform.scale(
        pygame.image.load(r"C:\Users\yerin\OneDrive\ë°”íƒ• í™”ë©´\ë ˆë²…\image\ë ˆë²…ë³´ì´.png").convert_alpha(), (300, 500))
    ê³µì£¼ë‹˜_image = pygame.transform.scale(
        pygame.image.load(r"C:\Users\yerin\OneDrive\ë°”íƒ• í™”ë©´\ë ˆë²…\image\ê³µì£¼ë‹˜.png").convert_alpha(), (300, 500))
    ê¸‰ì‹_image = pygame.image.load(r"C:\Users\yerin\OneDrive\ë°”íƒ• í™”ë©´\ë ˆë²…\image\ê¸‰ì‹.jpg").convert_alpha()
    ìƒˆë˜¥_image = pygame.image.load(r"C:\Users\yerin\OneDrive\ë°”íƒ• í™”ë©´\ë ˆë²…\image\ìƒˆë˜¥.jpg").convert_alpha() 
    
    ë ˆë²…ë³´ì´_rect = ë ˆë²…ë³´ì´_image.get_rect(center=(400, 400))
    ë ˆë²…ë³´ì´2_rect = ë ˆë²…ë³´ì´2_image.get_rect(center=(400, 400))
    ê³µì£¼ë‹˜_rect = ê³µì£¼ë‹˜_image.get_rect(center=(400, 400))
except pygame.error as e:
    print(f"ì´ë¯¸ì§€ ë¡œë“œ ì˜¤ë¥˜: {e}. ì´ë¯¸ì§€ ê²½ë¡œë¥¼ í™•ì¸í•´ ì£¼ì„¸ìš”.")
    # ëŒ€ì²´ ì´ë¯¸ì§€ (ë””ë²„ê¹…ìš©)
    bg = pygame.Surface((SCREEN_WIDTH, SCREEN_HEIGHT)); bg.fill((100, 100, 100))
    êµì‹¤1 = pygame.Surface((SCREEN_WIDTH, SCREEN_HEIGHT)); êµì‹¤1.fill((150, 150, 150))
    ë ˆë²…ë³´ì´_image = pygame.Surface((300, 300)); ë ˆë²…ë³´ì´_image.fill((255, 0, 0))
    ë ˆë²…ë³´ì´_rect = ë ˆë²…ë³´ì´_image.get_rect(center=(400, 400))
    ë ˆë²…ë³´ì´2_rect = ë ˆë²…ë³´ì´2_image.get_rect(center=(400, 400))
    ê³µì£¼ë‹˜_rect = ê³µì£¼ë‹˜_image.get_rect(center=(400, 400))
    ê¸‰ì‹_image = pygame.Surface((10, 10)); ê¸‰ì‹_image.fill((0, 255, 0))
    ìƒˆë˜¥_image = pygame.Surface((10, 10)); ìƒˆë˜¥_image.fill((0, 0, 0))


# --- í—¬í¼ í•¨ìˆ˜ ---
def wrap_text(text, font, max_width):
    text = text.strip() 
    if not text: 
        return []

    lines = []
    for line in text.split('\n'):
        line = line.strip()
        if not line:
            continue
            
        words = line.split(' ')
        current_line = ""
        for word in words:
            test_line = (current_line + " " + word).strip()
            if font.size(test_line)[0] <= max_width:
                current_line = test_line
            else:
                lines.append(current_line.strip())
                current_line = word
        lines.append(current_line.strip())
    
    return [line for line in lines if line]


def draw_dialog_box(screen, speaker, message_content, current_msg=None, current_index=None):
    # 1. ë°˜íˆ¬ëª…í•œ ëŒ€í™” ìƒì ë°°ê²½
    dialog_surface = pygame.Surface(DIALOG_RECT.size, pygame.SRCALPHA)
    dialog_surface.fill(DIALOG_BOX_COLOR)
    screen.blit(dialog_surface, DIALOG_RECT)

    # 2. í™”ì ì´ë¦„ ìƒì
    if speaker:
        name_surface = pygame.Surface(NAME_BOX_RECT.size, pygame.SRCALPHA)
        name_surface.fill((255, 105, 180, 220))
        screen.blit(name_surface, NAME_BOX_RECT)

        # í™”ì ì´ë¦„ í…ìŠ¤íŠ¸
        name_text = font_main.render(speaker, True, WHITE)
        screen.blit(name_text, (NAME_BOX_RECT.left + 10, NAME_TEXT_Y))

    # 3. ëŒ€í™” ë‚´ìš© í‘œì‹œ
    wrapped_text = wrap_text(message_content, font_main, DIALOG_RECT.width - 40)
    y_offset = TEXT_START_Y

    for line in wrapped_text:
        text_surface = font_main.render(line, True, WHITE)
        screen.blit(text_surface, (TEXT_START_X, y_offset))
        y_offset += font_main.get_height() + 5

    # ë‹¤ìŒìœ¼ë¡œ ë„˜ì–´ê°€ë¼ëŠ” í‘œì‹œ (ì•ˆì „í•˜ê²Œ current_msg ë˜ëŠ” current_index ì‚¬ìš©)
    show_next = True
    if current_msg is not None:
        # current_msgê°€ ("ì„ íƒ", ...) í˜•íƒœë©´ â–¼ í‘œì‹œ ì•ˆí•¨
        if isinstance(current_msg, tuple) and len(current_msg) >= 1 and current_msg[0] == "ì„ íƒ":
            show_next = False
    elif current_index is not None:
        if 0 <= current_index < len(messages):
            m = messages[current_index]
            if isinstance(m, tuple) and len(m) >= 1 and m[0] == "ì„ íƒ":
                show_next = False
        else:
            # ì¸ë±ìŠ¤ê°€ ë²”ìœ„ ë°–ì´ë©´ í‘œì‹œí•˜ì§€ ì•ŠìŒ(ì•ˆì „)
            show_next = False
    else:
        # fallback: ê¸°ì¡´ ë°©ì‹ ëŒ€ì‹  ì•ˆì „ ê²€ì‚¬
        if not (0 <= message_index < len(messages)):
            show_next = False
        else:
            m = messages[message_index]
            if isinstance(m, tuple) and len(m) >= 1 and m[0] == "ì„ íƒ":
                show_next = False

    if show_next:
        next_indicator = font_option.render("â–¼", True, WHITE)
        screen.blit(next_indicator, (DIALOG_RECT.right - 30, DIALOG_RECT.bottom - 30))


def draw_prev_button(screen, mouse_pos):
    """'ì´ì „' ë²„íŠ¼ì„ ê·¸ë¦¬ê³  í˜¸ë²„ íš¨ê³¼ë¥¼ ì ìš©í•©ë‹ˆë‹¤."""
    button_color = GRAY_BUTTON
    if PREV_BUTTON_RECT.collidepoint(mouse_pos):
        button_color = (120, 120, 120)

    pygame.draw.rect(screen, button_color, PREV_BUTTON_RECT, border_radius=5)
    prev_text = font_option.render("ì´ì „", True, WHITE)
    text_rect = prev_text.get_rect(center=PREV_BUTTON_RECT.center)
    screen.blit(prev_text, text_rect)

def draw_affection_status(screen):
    """í™”ë©´ ìƒë‹¨ì— í˜¸ê°ë„ ëª©ë¡ì„ í‘œì‹œ"""
    x = 10
    y = 10

    bg_height = font_affection.get_height() + 10
    total_width = 0

    for name in ë“±ì¥í•œ_ìºë¦­í„°:
        if name in í˜¸ê°ë„:
            text = f"{name}â™¥: {í˜¸ê°ë„[name]}"
            text_width, _ = font_affection.size(text)
            total_width += text_width + 25

    if total_width > 0:
        bg_surface = pygame.Surface((total_width, bg_height), pygame.SRCALPHA)
        bg_surface.fill((0, 0, 0, 150))
        screen.blit(bg_surface, (x, y))

        current_x = x + 5
        for name in ë“±ì¥í•œ_ìºë¦­í„°:
            if name in í˜¸ê°ë„:
                text = f"{name}â™¥: {í˜¸ê°ë„[name]}"
                affection_surface = font_affection.render(text, True, LIGHT_PINK)
                text_width, _ = affection_surface.get_size()
                screen.blit(affection_surface, (current_x, y + 5))
                current_x += text_width + 20

# --- ì—”ë”© í™”ë©´ ê·¸ë¦¬ê¸° í•¨ìˆ˜ ---
def draw_end_screen(screen, mouse_pos):
    """ì—”ë”© í™”ë©´ê³¼ ë‹¤ì‹œí•˜ê¸° ë²„íŠ¼ì„ ê·¸ë¦½ë‹ˆë‹¤."""
    screen.fill(BLACK) 

    # ìµœì¢… ì—”ë”© í…ìŠ¤íŠ¸
    final_text = font_main.render("--- ê²Œì„ ì¢…ë£Œ ---", True, WHITE)
    final_rect = final_text.get_rect(center=(SCREEN_WIDTH // 2, SCREEN_HEIGHT // 2 - 100))
    screen.blit(final_text, final_rect)
    
    # ìµœì¢… í˜¸ê°ë„ í‘œì‹œ
    y_offset = final_rect.bottom + 20
    for name, value in í˜¸ê°ë„.items():
        text = f"{name}â™¥: {value}"
        text_surf = font_affection.render(text, True, LIGHT_PINK)
        text_rect = text_surf.get_rect(center=(SCREEN_WIDTH // 2, y_offset))
        screen.blit(text_surf, text_rect)
        y_offset += 30

    # ë‹¤ì‹œí•˜ê¸° ë²„íŠ¼ ê·¸ë¦¬ê¸°
    button_color = GRAY_BUTTON
    if RESTART_RECT.collidepoint(mouse_pos):
        button_color = (120, 120, 120)

    pygame.draw.rect(screen, button_color, RESTART_RECT, border_radius=10)
    restart_text = font_main.render("ë‹¤ì‹œí•˜ê¸°", True, WHITE)
    restart_rect = restart_text.get_rect(center=RESTART_RECT.center)
    screen.blit(restart_text, restart_rect)


# --- ì„ íƒì§€ ë²„íŠ¼ í´ë˜ìŠ¤ (ë™ì  ë„ˆë¹„ ì ìš©) ---
class ChoiceButton(object):
    def __init__(self, x, y, text, value, font, padding_x, height=50):
        self.text = text
        self.value = value
        self.font = font

        text_width, _ = font.size(self.text)
        button_width = text_width + padding_x

        self.rect = pygame.Rect(x, y, button_width, height)

        self.color = (50, 50, 50)
        self.hover_color = (100, 100, 100)
        self.current_color = self.color

        self.text_surface = self.font.render(self.text, True, WHITE)
        self.text_rect = self.text_surface.get_rect(center=self.rect.center)

    def draw(self, surface):
        pygame.draw.rect(surface, self.current_color, self.rect, border_radius=10)
        surface.blit(self.text_surface, self.text_rect)

    def check_hover(self, mouse_pos):
        if self.rect.collidepoint(mouse_pos):
            self.current_color = self.hover_color
        else:
            self.current_color = self.color
choice = None
prev_message_index = -1
# --- ë©”ì¸ ë£¨í”„ ---
clock = pygame.time.Clock()
running = True
options = [] 
choice = None
prev_message_index = -1  # ë©”ì‹œì§€ ì¸ë±ìŠ¤ ë³€í™” ì²´í¬ìš©

while running:
    mouse_pos = pygame.mouse.get_pos()
    events = pygame.event.get()
    state_changed = False

    # ğŸŒŸ ê²Œì„ ì˜¤ë²„ ìƒíƒœ ì²˜ë¦¬
    if game_over:
        for event in events:
            if event.type == pygame.QUIT:
                running = False
            if event.type == pygame.MOUSEBUTTONDOWN and event.button == 1:
                if RESTART_RECT.collidepoint(mouse_pos):
                    reset_game() 
                    break 
        
        draw_end_screen(screen, mouse_pos)
        pygame.display.flip()
        clock.tick(30)
        continue 
 
        # ì•ˆì „í•˜ê²Œ message_index ë³´ì •
    if message_index < 0:
        message_index = 0
    if message_index >= len(messages):
        # ë²”ìœ„ë¥¼ ë²—ì–´ë‚¬ë‹¤ë©´ ë§ˆì§€ë§‰ ì¸ë±ìŠ¤ë¡œ ë³´ì •
        message_index = max(0, len(messages) - 1)
        # (ê¸°ì¡´ ë¡œì§ ìœ ì§€: ì—”ë”©ì´ë©´ game_over ì²˜ë¦¬)
        if messages and messages[-1][0] == "ì—”ë”©":
            game_over = True


    current_msg = messages[message_index]
        # ë©”ì‹œì§€ ì¸ë±ìŠ¤ê°€ ë°”ë€Œë©´ ì´ì „ì— ë§Œë“¤ì–´ì§„ ì˜µì…˜ì„ ì´ˆê¸°í™”
    if message_index != prev_message_index:
        options = []
        choice = None
    prev_message_index = message_index

    is_choice_scene = isinstance(current_msg, tuple) and len(current_msg) >= 3 and isinstance(current_msg[2], list)

    # --- ì„ íƒì§€ ìƒì„± (message_index ë³€ê²½ ì‹œ optionsê°€ ë¹„ì›Œì§€ëŠ” ë¡œì§ê³¼ í•¨ê»˜ ì‚¬ìš©ë¨) ---
    if is_choice_scene and not options:
        # current_msg êµ¬ì¡°: (íƒ€ì´í‹€/í™”ì, ì„¤ëª…(ë˜ëŠ” íƒ€ì´í‹€), [ (ë²„íŠ¼í…ìŠ¤íŠ¸, ê°’), ... ])
        try:
            title = current_msg[1]
            choices_data = current_msg[2]
        except Exception:
            choices_data = []
        # ë²„íŠ¼ë“¤ ì„¸ë¡œ ë°°ì¹˜ ê³„ì‚°
        total_height = len(choices_data) * 60
        # ë‹¤ì´ì–¼ë¡œê·¸ ìœ„ìª½ì— ë°°ì¹˜í•˜ë ¤ ì‹œë„, ë„ˆë¬´ ìœ„ë¡œ ê°€ë©´ ì•„ë˜ìª½ìœ¼ë¡œ ê³ ì •
        start_y = DIALOG_RECT.top - total_height - 10
        if start_y < 10:
            start_y = SCREEN_HEIGHT - 400

        options = []
        button_x = DIALOG_RECT.left + 50
        for i, choice_item in enumerate(choices_data):
            if isinstance(choice_item, (list, tuple)):
                text, value = choice_item[0], choice_item[1]
            else:
                text = str(choice_item)
                value = str(i + 1)

            button_y = start_y + i * 60
            new_button = ChoiceButton(button_x, button_y, text, value, font_option, PADDING_X, height=50)
            options.append(new_button)


    # --- ë°°ê²½
    if message_index == 22 or message_index == 23:
        screen.fill(BLACK) 
    elif message_index <= 1:
        screen.blit(bg, (0, 0))
    elif message_index <= 13 or (message_index >= 17 and message_index <= 30):
        screen.blit(êµì‹¤1, (0, 0))
    elif (message_index >= 31):
        screen.blit(ìš´ë™ì¥, (0, 0))
    else:
        screen.blit(bg, (0, 0))

    # --- ìºë¦­í„°
    if message_index >= 4 and message_index <= 6:
        screen.blit(ë ˆë²…ë³´ì´_image, ë ˆë²…ë³´ì´_rect)
        if "ë ˆë²…ë³´ì´" not in ë“±ì¥í•œ_ìºë¦­í„°: ë“±ì¥í•œ_ìºë¦­í„°.add("ë ˆë²…ë³´ì´")
    elif message_index >= 12 and message_index <= 17:
        screen.blit(ë ˆë²…ë³´ì´_image, ë ˆë²…ë³´ì´_rect)
    elif (message_index >= 14 and message_index <= 15) or (message_index >= 50 and message_index <= 56) or message_index==59 :
        screen.blit(ë ˆë²…ë³´ì´2_image, ë ˆë²…ë³´ì´2_rect)
    elif (message_index >= 17 and message_index <= 20) or (message_index >= 24 and message_index<= 46) or message_index>=61 :
        screen.blit(ê³µì£¼ë‹˜_image, ê³µì£¼ë‹˜_rect)
        if "ê³µì£¼ë‹˜" not in ë“±ì¥í•œ_ìºë¦­í„°:
            ë“±ì¥í•œ_ìºë¦­í„°.add("ê³µì£¼ë‹˜")

    # --- ì„ íƒì§€
    if is_choice_scene:
        title = current_msg[1]
        # current_msgë¥¼ ì „ë‹¬ -> draw_dialog_boxê°€ ì•ˆì „í•˜ê²Œ ì²˜ë¦¬
        draw_dialog_box(screen, "", title, current_msg=current_msg)
        for button in options:
            button.draw(screen)
    else:
        if isinstance(current_msg, tuple) and len(current_msg) >= 2:
            speaker, content = current_msg[0], current_msg[1]
            draw_dialog_box(screen, speaker, content, current_msg=current_msg)
        else:
            draw_dialog_box(screen, "", str(current_msg), current_msg=current_msg)



    # --- ì´ë²¤íŠ¸ ì²˜ë¦¬ ---
    for event in events:
        if event.type == pygame.QUIT:
            running = False

        if event.type == pygame.MOUSEBUTTONDOWN and event.button == 1:
            if message_index > 0 and PREV_BUTTON_RECT.collidepoint(mouse_pos):
                message_index -= 1
                options = []
                choice = None
                continue

        if is_choice_scene:
            if event.type == pygame.MOUSEBUTTONDOWN and event.button == 1:
                for button in options:
                    if button.rect.collidepoint(mouse_pos):
                        choice = button.value
                        options = [] 
                        
                        # --- ê° ì„ íƒì§€ì— ë”°ë¥¸ ë¶„ê¸° ---
                        if message_index == 4:
                            ë“±ì¥í•œ_ìºë¦­í„°.add("ë ˆë²…ë³´ì´")
                            í˜¸ê°ë„["ë ˆë²…ë³´ì´"] -= 10
                            
                        elif message_index == 15:
                            if choice == "1":
                                messages[message_index+1] = ("ì™•ìë‹˜", "''ë­ë¼ë„ í•´ì•¼ê² ë‹¤!!''\nì´ì–´ì§€ëŠ” ë¯¸ë‹ˆê²Œì„ìœ¼ë¡œ ë²½ëŒì„ ë¿Œì…”ì„œ ë•ì.")
                                pygame.display.flip()
                                pygame.time.delay(500)
                                result = brick_game()
                                if result:
                                    í˜¸ê°ë„["ë ˆë²…ë³´ì´"] += 40
                                    messages[message_index+1] = ("ì™•ìë‹˜", "ë²½ëŒì„ ë‹¤ ë¶€ì‰ˆë‹¤! ë‚¨ìì• ê°€ ë‚˜ì—ê²Œ ê°ì‚¬ ì¸ì‚¬ë¥¼ í•˜ê³  ì–´ë””ë¡ ê°€ ì‚¬ë¼ì¡Œë‹¤. ì–´ëŠìƒˆ ë¬´ë‹¹ë²Œë ˆê°€ ë‚ ì•„ê°”ë‹¤.")
                                else:
                                    í˜¸ê°ë„["ë ˆë²…ë³´ì´"] -= 10
                                    messages[message_index+1] = ("ì™•ìë‹˜", "ë²½ëŒì„ ì „ë¶€ ë§‰ì§€ ëª»í–ˆë‹¤... ë‚¨ìì• ëŠ” ì‚¬ë¼ì¡Œë‹¤.")
                                message_index += 1 
                                state_changed = True
                                
                            elif choice == "2":
                                messages[message_index+1] = ("ì™•ìë‹˜", "ë‚˜ëŠ” ë‹¤ì‹œ ë°˜ìœ¼ë¡œ ëŒì•„ê°€ ìë¦¬ì— ì•‰ì•˜ë‹¤.")
                                í˜¸ê°ë„["ë ˆë²…ë³´ì´"] -= 40
                                message_index += 1
                                state_changed = True

                        elif message_index == 20:
                            if choice == "1":
                                í˜¸ê°ë„["ê³µì£¼ë‹˜"] -= 10
                                message_index = 21
                            elif choice == "2":
                                í˜¸ê°ë„["ê³µì£¼ë‹˜"] += 10
                                message_index = 24
                            elif choice == "3":
                                í˜¸ê°ë„["ê³µì£¼ë‹˜"] += 5
                                message_index = 26

                        elif message_index == 35:
                            if choice == "1":
                                pygame.time.delay(200)
                                score, hit_bad = sky_food_game()
                                if hit_bad:
                                    # ë°°ë“œ ì—”ë”© (ìƒˆë˜¥ ë§ìŒ)
                                    # messages ë¦¬ìŠ¤íŠ¸ì˜ ë§¨ ë’¤ì— ë‘ ê°œì˜ ì—”ë”© ë©”ì‹œì§€ ì¶”ê°€
                                    messages.append(("ì—”ë”©", f"ë–¨ì–´ì§„ ìœ„í—˜ë¬¼ì„ ë§ì•˜ìŠµë‹ˆë‹¤... ë°°ë“œì—”ë”©ì…ë‹ˆë‹¤. (íšë“ ì ìˆ˜: {score})"))
                                    messages.append(("ì—”ë”©", "'ë°°ë“œì—”ë”©'.")) # ìµœì¢… ì—”ë”© ë©”ì‹œì§€
                                    
                                    # ğŸŒŸ ìˆ˜ì • í¬ì¸íŠ¸: ìƒˆë¡œ ì¶”ê°€ëœ ì²« ë²ˆì§¸ ì—”ë”© ë©”ì‹œì§€ë¡œ ë°”ë¡œ ì´ë™
                                    message_index = len(messages) - 2 
                                    state_changed = True
                                              
                                else:
                                    # ì„±ê³µ ë©”ì‹œì§€
                                    # ... í˜¸ê°ë„ ê³„ì‚° ë¡œì§ ...
                                    messages.append(("ì™•ìë‹˜", f"í•˜ëŠ˜ì—ì„œ ê¸‰ì‹ì„ ì˜ ë°›ì•„ë¨¹ì—ˆë‹¤!"))
                                    
                                    # ì¸ë±ìŠ¤ë¥¼ ë‹¤ìŒ ë©”ì‹œì§€(36)ë¡œ ì •í™•íˆ ì„¤ì •
                                    message_index += 1 
                                    state_changed = True
                                    
                                    break
                            
                        elif message_index == 39:
                            if choice == "1":
                                í˜¸ê°ë„["ê³µì£¼ë‹˜"] += 20
                                message_index = 40
                            elif choice == "2":
                                í˜¸ê°ë„["ê³µì£¼ë‹˜"] -= 20
                                message_index = 41
                            elif choice == "3":
                                message_index = 42
                                
                        elif message_index == 53:
                            if choice == "1":
                                message_index += 1
                            elif choice == "2":
                                í˜¸ê°ë„["ë ˆë²…ë³´ì´"] += 30
                                message_index += 1
                            elif choice == "3":
                                í˜¸ê°ë„["ë ˆë²…ë³´ì´"] -= 30
                                message_index += 1
                                
                        elif message_index == 57:
                            if choice == "1":
                                pygame.time.delay(200)
                                
                                # ìŠ¤ë„¤ì´í¬ ê²Œì„ ì‹¤í–‰
                                score, success = snake_game() 
                                
                                if success:
                                    í˜¸ê°ë„["ë ˆë²…ë³´ì´"] += 50
                                    
                                    # ğŸš¨ [ìˆ˜ì •] ì„±ê³µ ë©”ì‹œì§€ë¥¼ ì¶”ê°€í•˜ëŠ” ëŒ€ì‹ , ì¸ë±ìŠ¤ 58ë¡œ ë°”ë¡œ ì í”„í•©ë‹ˆë‹¤.
                                    message_index = 58 
                                    state_changed = True # í™”ë©´ ê°±ì‹  ê°•ì œ
                                
                                else:
                                    í˜¸ê°ë„["ë ˆë²…ë³´ì´"] -= 50
                                    
                                    # ì‹¤íŒ¨ ì—”ë”© ë¡œì§ (ì´ ë¶€ë¶„ì€ ê·¸ëŒ€ë¡œ ìœ ì§€)
                                    messages.append(("ì—”ë”©", "ë±€ì´ ë„ˆë¬´ ë¹¨ë¼ ë§‰ì§€ ëª»í–ˆë‹¤... ê²°êµ­ ë±€ì—ê²Œ ë¬¼ë ¤ë²„ë ¸ë‹¤."))
                                    messages.append(("ì—”ë”©", "'ë±€ë“œì—”ë”©.'"))
                                    
                                    # ì‹¤íŒ¨ ì—”ë”©ìœ¼ë¡œ ì í”„
                                    message_index = len(messages) - 2 
                                    state_changed = True
                                    
                                break # ì„ íƒì§€ ì²˜ë¦¬ ë£¨í”„ ì¢…ë£Œ
                            
                        elif message_index == 62:
                            í˜¸ê°ë„["ê³µì£¼ë‹˜"] += í˜¸ê°ë„["ë ˆë²…ë³´ì´"]
                            if í˜¸ê°ë„["ê³µì£¼ë‹˜"] > 100:
                                message_index = 63 # ê³ ë°± ë©”ì‹œì§€
                                
                            else:
                                message_index = 66 # ì „í•™ ë©”ì‹œì§€

                            continue
                                
                        elif message_index == 65:
                            if choice == "1":
                                í˜¸ê°ë„["ê³µì£¼ë‹˜"] += 100
                                message_index = 68
                            elif choice == "2":
                                í˜¸ê°ë„["ê³µì£¼ë‹˜"] -= 20
                                message_index = 66
                                
                        elif message_index == 67:
                            game_over = True
                            continue
                        
                        elif message_index == 70:
                            reset_game

                for button in options:
                    button.check_hover(mouse_pos)

        else:
            if (event.type == pygame.KEYDOWN and event.key == pygame.K_RETURN) or \
               (event.type == pygame.MOUSEBUTTONDOWN and event.button == 1):
            
                # --- ì¸ë±ìŠ¤ ì í”„/ë¶„ê¸° ì²˜ë¦¬ ---
                if message_index == 21:
                    message_index = 66
                elif message_index == 66:
                    game_over = True # ìµœì¢… ì—”ë”© í›„ ê²Œì„ ì˜¤ë²„
                    continue
                elif message_index == len(messages) - 2 and messages[message_index][0] == "ì—”ë”©":
                    message_index += 1
                elif message_index == len(messages) - 1 and messages[message_index][0] == "ì—”ë”©":
                        game_over = True
                        continue
            
                
                elif message_index in [40, 41, 42]:
                    message_index += 1
                
                else:
                    message_index += 1 # ê¸°ë³¸ ì§„í–‰
                    
                    
    if state_changed:
        pygame.event.clear()
        continue

    # --- ê·¸ë¦¬ê¸° ---
    draw_affection_status(screen)

    if message_index > 0:
        draw_prev_button(screen, mouse_pos)

    if is_choice_scene:
        title = current_msg[1]
        draw_dialog_box(screen, "", title)
        for button in options:
            button.draw(screen)
    else:
        if isinstance(current_msg, tuple) and len(current_msg) >= 2:
            speaker, content = current_msg[0], current_msg[1]
            draw_dialog_box(screen, speaker, content)
        else:
            draw_dialog_box(screen, "", str(current_msg))

    pygame.display.flip()
    clock.tick(30)

pygame.quit()
sys.exit()
